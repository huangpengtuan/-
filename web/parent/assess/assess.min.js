(function(angular){'use strict';angular.module('Massess',['ngRoute']).config(['$routeProvider',function($routeProvider){$routeProvider .when('/assIni/:TID/:CID',{templateUrl:'assess/assIni.html',controller:'assIniCtl'}).when('/assShow/:TID/:CID',{templateUrl:'assess/assShow.html',controller:'assShowCtl'}).when('/assAgain/:TID/:CID',{templateUrl:'assess/assAgain.html',controller:'assAgainCtl'})}]).controller('assIniCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.currId=$routeParams.CID;$scope.teatherId=$routeParams.TID;var gradeT=document.getElementsByClassName("gradeT");$scope.starD=0;for(var i=0;i<gradeT.length;i+=1){gradeT[i].onclick=function(){var indexx=$(".gradeT").index($(this));for(var i=0;i<gradeT.length;i+=1){$(".gradeT").removeClass("activeG");$(".gradeImg").attr('src',"img/icon_score_empty.png")}$(this).addClass("activeG").animate({width:'4rem'},"slow");$(".gradeImg").eq(indexx).attr('src',"img/icon_score.png").animate({width:'3rem'},"slow").animate({width:'2rem'},"slow");$scope.starD=$(".activeG").attr('data-grade');$scope.$apply()}}$scope.assSubmit=function(){var content=$(".assCText").val();var Score=$(".activeG").attr('data-grade');$.ajax({type:"post",url:"/comment/addCommentByCurriculum",data:{"currId":$scope.currId,"content":content,"parentScore":Score,},datatype:"json",success:function(data){if(!data.isSuccess){alert(data.msg)}else if(data.isSuccess){alert("您的评价已成功提交");$location.path('/assShow/'+$scope.teatherId+'/'+$scope.currId)}$scope.$apply()}})}}]).controller('assShowCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.currId=$routeParams.CID;$scope.teatherId=$routeParams.TID;$scope.comments='';$.ajax({type:"post",url:"/comment/getCommentByParent",data:{"teacherId":$scope.teatherId,},datatype:"json",success:function(data){$scope.comments=data.object;$scope.$apply()}})}]).controller('assAgainCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.currId=$routeParams.CID;$scope.teatherId=$routeParams.TID;$scope.comments='';$.ajax({type:"post",url:"/comment/getCommentByParent",data:{"teacherId":$scope.teatherId,},datatype:"json",success:function(data){$scope.comments=data.object;$scope.$apply()}});$scope.assSubmit=function(){var content=$(".assCText").val();$.ajax({type:"post",url:"/comment/addContentByCurriculum",data:{"currId":$scope.currId,"addContent":content,},datatype:"json",success:function(data){if(!data.isSuccess){alert(data.msg)}else if(data.isSuccess){alert("您的评价已成功提交");$location.path('/assShow/'+$scope.teatherId+'/'+$scope.currId)}$scope.$apply()}})}}])})(angular);