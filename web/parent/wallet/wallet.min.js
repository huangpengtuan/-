(function(angular){'use strict';angular.module('Mwallet',['ngRoute']).config(['$routeProvider',function($routeProvider){$routeProvider .when('/wallet/',{templateUrl:'wallet/wallet.html',controller:'walletCtl'}).when('/FWater/',{templateUrl:'FlowingWater/FlowingWater.html',controller:'FlowingWaterCtl'}).when('/WDCash/',{templateUrl:'wallet/withdrawCash.html',controller:'wdCashCtl'}).when('/WDCRecord/',{templateUrl:'FlowingWater/wdCRecord.html',controller:'wCashReCtl'}).when('/feedback/',{templateUrl:'wallet/feedback.html',controller:'feedbackCtl'}).when('/duihuanjilu/',{templateUrl:'FlowingWater/duihuanjilu.html',controller:'duihuanjiluCtl'}).when('/payment/:MN/:ID',{templateUrl:'wallet/payment.html',controller:'paymentCtl'}).when('/noCard/',{templateUrl:'wallet/noCard.html',controller:'NoCardCtl'}).when('/RCard/',{templateUrl:'wallet/reviseCard.html',controller:'RCardCtl'}).when('/recharge/',{templateUrl:'wallet/recharge.html',controller:'rechargeCtl'})}]).controller('walletCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.users='';$.ajax({type:"post",url:"/c/userInfo",data:{},datatype:"json",success:function(data){$scope.users=data;$scope.$apply()}});$scope.Withdrawalss=function(){$.ajax({type:"post",url:"/bankCard/getBankCard",data:{},datatype:"json",success:function(data){if(data.object){$location.path('/WDCash/')}else if(!data.object){$location.path('/noCard/')}$scope.$apply()}})}}]).controller('FlowingWaterCtl',['$scope',function($scope){var PTNumber=1;var PTSize=30;$scope.fwlists='';$scope.totalRow=1000;$.ajax({type:"post",url:"/balanceRecord/getBalanceRecordList",data:{"pageIndex":1,"pageSize":PTSize,},datatype:"json",success:function(data){$scope.totalRow=data.totalRow;$scope.fwlists=data.list;console.log(data);$scope.$apply()}});$(window).bind("scroll",function(){if($(document).scrollTop()+$(window).height()>$(document).height()+40){PTSize+20;$.ajax({type:"post",url:"/p/getFriendsByParent",data:{"pageIndex":PTNumber,"pageSize":PTSize,},datatype:"json",success:function(data){$scope.fwlists=data.list;$scope.$apply()}})}})}]).controller('wdCashCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.cardInfo='';$.ajax({type:"post",url:"/bankCard/getBankCard",data:{},datatype:"json",success:function(data){$scope.cardInfo=data.object;$scope.$apply()}});$scope.usersInfo='';$.ajax({type:"post",url:"/c/userInfo",data:{},datatype:"json",success:function(data){$scope.usersInfo=data;$scope.$apply()}});$scope.wDCmoney=function(){var amounts=$('.MoneyNumber').val();$.ajax({type:"post",url:"/withdraw/withdrawalApply",data:{"amount":amounts},datatype:"json",success:function(data){alert(data.msg);if(data.isSuccess){location.reload()}$scope.$apply()}})}}]).controller('wCashReCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var PTNumber=1;var PTSize=30;$scope.totalRow=1000;$scope.wdCRecords='';$.ajax({type:"post",url:"/withdraw/withdrawList",data:{"pageNumber":1,"pageSize":30,},datatype:"json",success:function(data){$scope.wdCRecords=data.list;$scope.totalRow=data.totalRow;$scope.$apply()}});$(window).bind("scroll",function(){if($(document).scrollTop()+$(window).height()>$(document).height()+40){PTSize+20;$.ajax({type:"post",url:"/withdraw/withdrawList",data:{"pageNumber":PTNumber,"pageSize":PTSize,},datatype:"json",success:function(data){$scope.wdCRecords=data.list;$scope.$apply()}})}})}]).controller('feedbackCtl',['$scope',function($scope){$scope.submitfeedback=function(){var feedback=$(".feedback textarea").val();if(feedback){$.ajax({type:"post",url:"/c/feedbackSave",data:{"content":feedback},datatype:"json",success:function(data){}});alert('感谢您提出的建议和意见，我们将努力做得更好');window.location.reload()}else{alert('请填写您的建议和意见')}}}]).controller('duihuanjiluCtl',['$scope',function($scope){}]).controller('paymentCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var paynumbers=$routeParams.MN;var currId=$routeParams.ID;$scope.paynumbers=paynumbers;$scope.payWei=function(){window.location.href="/c/pay/payCurriculumByWechat?currId="+currId};$scope.payWal=function(){$.ajax({type:"post",url:"/c/curriculum/payCurriculum",data:{"currId":currId,},datatype:"json",success:function(data){alert(data.msg);$location.path('/dynamic/');$scope.$apply()}})}}]).controller('NoCardCtl',['$scope',function($scope){}]).controller('RCardCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.reviCard=function(){var cardinfo=$('.reCardinfo').serializeArray();$.ajax({type:"post",url:"/bankCard/tiedCard",data:{"bank.bank_name":cardinfo[0].value,"bank.branch_name":cardinfo[1].value,"bank.card_number":cardinfo[2].value,"bank.username":cardinfo[3].value},datatype:"json",success:function(data){alert(data.msg);$location.path('/WDCash/');$scope.$apply()}})}}]).controller('rechargeCtl',['$scope',function($scope){}])})(angular);