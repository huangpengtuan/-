(function(angular){'use strict';angular.module('MCram',['ngRoute']).directive('onFinishRender',function($timeout){return{restrict:'A',link:function(scope,element,attr){if(scope.$last===true){$timeout(function(){scope.$emit('ngRepeatFinished')})}}}}).config(['$routeProvider',function($routeProvider){$routeProvider .when('/applycram/',{templateUrl:'cramschool/applycram.html',controller:'applycramCtl'}).when('/ACinsure/',{templateUrl:'cramschool/ACinsure.html',controller:'ACinsureCtl'}).when('/ModifyData/:ID',{templateUrl:'cramschool/ModifyData.html',controller:'ModifyDataCtl'}).when('/Creategroup/:ID',{templateUrl:'cramschool/Creategroup.html',controller:'CreategroupCtl'}).when('/CreateCurri/:ID',{templateUrl:'cramschool/CreateCurri.html',controller:'CreateCurriCtl'}).when('/reviseCurri/:CURID/:SHID',{templateUrl:'cramschool/reviseCurri.html',controller:'reviseCurriCtl'}).when('/curriculum/:ID',{templateUrl:'cramschool/curriculum.html',controller:'curriculumCtl'})}]).controller('applycramCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){tabsfn('zoneBody','.zoneBody','.zoneBody01','tabItemactive');$scope.submitAuthen=function(e){var formData=new FormData($("#withdrawForm")[0]);var Cramobject=e;console.log(formData);console.log(Cramobject);if(!Cramobject){$.ajax({type:"post",url:"/cramSchool/apply",data:formData,datatype:"json",async:false,cache:false,contentType:false,processData:false,success:function(data){if(!data.isSuccess){alert(data.msg)}else{$location.path('/ACinsure/')}}})}else if(Cramobject.state==1){$.ajax({type:"post",url:"/cramSchool/applyEdit",data:formData,datatype:"json",async:false,cache:false,contentType:false,processData:false,success:function(data){if(data.isSuccess){$location.path('/ACinsure/')}else if(!data.isSuccess){alert(data.msg)}}})}};$scope.BondSH=function(e){$(e).fadeToggle()};$scope.cram='';$scope.cramID='';$scope.teacher_name='';$scope.address='';$scope.aboutcram='';$scope.cram_avatar='';$scope.teacher_phone='';$scope.cram_name='';$scope.lat=22.543099;$scope.lng=114.057868;$scope.area_id=440300;$.ajax({type:"post",url:"/cramSchool/getCramSchoolState",data:{},datatype:"json",success:function(data){if(data.object){$scope.cram=data;$scope.cramID=data.object.id;$scope.teacher_name=data.object.teacher_name;$scope.address=data.object.address;$scope.aboutcram=data.object.about;$scope.cram_avatar=data.object.class_avatar;$scope.teacher_phone=data.object.teacher_phone;$scope.class_name=data.object.class_name;$scope.lat=data.object.lat;$scope.lng=data.object.lng;$scope.area_id=data.object.area_id}else{$scope.cram_avatar='img/morentouxiang.jpg'}$scope.$apply()}});$scope.margin='';$.ajax({type:"post",url:"/cramSchool/cramApplyCost",data:{},datatype:"json",success:function(data){$scope.margin=data.cram_apply_cost;$scope.$apply()}});$scope.cramStyles='';$.ajax({type:"post",url:"/cramSchoolType/getCramSchoolTypeList",data:{},datatype:"json",success:function(data){$scope.cramStyles=data.object;$scope.$apply()}})}]).controller('ACinsureCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var applystates=document.getElementsByClassName("AC-Text02");for(var i=0;i<applystates.length;i+=1){applystates[i].onclick=function(){var indexx=$(".AC-Text02").index($(this));for(var i=0;i<applystates.length;i+=1){$(".AC-Text02").removeClass("AC-active");$(".icon-Uncheck").removeClass("AC-check");$(".AC-applystate").fadeOut()}$(this).addClass("AC-active");$(".icon-Uncheck").eq(indexx).addClass("AC-check");$(".AC-applystate").eq(indexx).fadeIn()}}$scope.cram='';$scope.teacher_phone='';$scope.cram_name='';$scope.margin='';$.ajax({type:"post",url:"/cramSchool/getCramSchoolState",data:{},datatype:"json",success:function(data){console.log(data);if(data.object){$scope.cram=data.object;$scope.teacher_phone=data.object.teacher_phone;$scope.class_name=data.object.class_name;$scope.margin=data.object.margin;$scope.$apply()}}});$scope.applyStyle=1;$scope.applystateWaY=function(e){$scope.applyStyle=e};$scope.submitCrams=function(id){var cramID=id;if($scope.applyStyle==1){window.location.href="/c/pay/payForCramSchoolApply?cramSchoolId="+cramID}else if($scope.applyStyle==2){$.ajax({type:"post",url:"/cramSchool/payForApply",data:{"cramSchoolId":cramID,},datatype:"json",success:function(data){alert(data.msg);$location.path('/news/'+3);$scope.$apply()}})}}}]).controller('ModifyDataCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){tabsfn('zoneBody','.zoneBody','.zoneBody01','tabItemactive');$scope.cram='';$scope.cramID='';$scope.teacher_name='';$scope.address='';$scope.aboutcram='';$scope.cram_avatar='';$scope.teacher_phone='';$scope.cram_name='';$.ajax({type:"post",url:"/cramSchool/getCramSchoolState",data:{},datatype:"json",success:function(data){if(data.object){$scope.cram=data;$scope.cramID=data.object.id;$scope.teacher_name=data.object.teacher_name;$scope.address=data.object.address;$scope.aboutcram=data.object.about;$scope.cram_avatar=data.object.class_avatar;$scope.teacher_phone=data.object.teacher_phone;$scope.class_name=data.object.class_name}else{$scope.cram_avatar='img/morentouxiang.jpg'}$scope.$apply()}});$scope.submitModify=function(){var formData=new FormData($("#withdrawForm")[0]);$.ajax({type:"post",url:"/cramSchool/applyEdit",data:formData,datatype:"json",async:false,cache:false,contentType:false,processData:false,success:function(data){$location.path('/news/'+3)}})};$scope.cramStyles='';$.ajax({type:"post",url:"/cramSchoolType/getCramSchoolTypeList",data:{},datatype:"json",success:function(data){$scope.cramStyles=data.object;$scope.$apply()}})}]).controller('CreategroupCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.cramSchoolId=$routeParams.ID;$scope.info={};$scope.info.operate={};var simp='';$.ajax({type:"post",url:"/cramCourseGroup/getGroup",data:{"cramSchoolId":$scope.cramSchoolId,},datatype:"json",success:function(data){$scope.info.operate=data.object;$scope.$apply()}});$scope.info.add=function(){var $index=$scope.info.operate.length;if($index<=7){$scope.info.operate.splice($index+1,0,{"cramSchoolId":$scope.cramSchoolId,"groupName":""})}else{alert('最多只能创建八个分组！')}};$scope.info.delete=function($index,groupID){$scope.info.operate.splice($index,1);$.ajax({type:"post",url:"/cramCourseGroup/deleteGroup",data:{"groupId":groupID,},datatype:"json",success:function(data){}})};var TTTT="";$scope.info.result=function(){TTTT=JSON.stringify($scope.info.operate);$.ajax({type:"post",url:"/cramCourseGroup/addGroup",data:{"groups":TTTT,},datatype:"json",success:function(data){if(!data.isSuccess){alert(data.msg)}else if(data.isSuccess){$location.path('/CreateCurri/'+$scope.cramSchoolId)}$scope.$apply()}})}}]).controller('CreateCurriCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.cramSchoolId=$routeParams.ID;$scope.Cramgroup={};var simp='';$.ajax({type:"post",url:"/cramCourseGroup/getGroup",data:{"cramSchoolId":$scope.cramSchoolId,},datatype:"json",success:function(data){$scope.Cramgroup=data.object;$scope.$apply()}});tabsfn('zoneBody','.zoneBody','.zoneBody01','tabItemactive');var applystates=document.getElementsByClassName("Discount");for(var i=0;i<applystates.length;i+=1){applystates[i].onclick=function(){var indexx=$(".Discount").index($(this));$(this).toggleClass("AC-active");$(".icon-Uncheck").eq(indexx).toggleClass("Discount-IMG")}}$scope.getKemu='';$.ajax({type:"post",url:"/subject/getSubjectListBySchool",data:{"cramSchoolId":$scope.cramSchoolId,},datatype:"json",success:function(data){$scope.getKemu=data.object;console.log(data);$scope.$apply()}});$scope.CreateCurri=function(){var CCurriData=$('#CreateCu').serializeArray();var totailmonek=CCurriData[3].value*CCurriData[4].value;var zhekouTF=0;if($('#mianfei').is('.AC-active')){zhekouTF=1}var zhenumbers=$('#zhenumber').val();$.ajax({type:"post",url:"/cramCourse/createCramCourse",data:{'c.cram_school_id':$scope.cramSchoolId,'c.cram_course_group_id':CCurriData[0].value,'c.subject_id':CCurriData[1].value,'c.course_name':CCurriData[2].value,'c.course_hour':CCurriData[3].value,'c.hour_price':CCurriData[4].value,'c.original_price':totailmonek,'c.address':CCurriData[7].value,'c.introduction':CCurriData[8].value,'c.area_id':CCurriData[6].value,'c.penalty':CCurriData[5].value,'c.try_out':zhekouTF,'c.discount':zhenumbers,},datatype:"json",success:function(data){alert(data.msg);if(data.isSuccess){window.location.reload()}}})}}]).controller('reviseCurriCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.curriId=$routeParams.CURID;$scope.cramSchoolId=$routeParams.SHID;$scope.Cramgroup={};var simp='';$.ajax({type:"post",url:"/cramCourseGroup/getGroup",data:{"cramSchoolId":$scope.cramSchoolId,},datatype:"json",success:function(data){$scope.Cramgroup=data.object;$scope.$apply()}});tabsfn('zoneBody','.zoneBody','.zoneBody01','tabItemactive');var applystates=document.getElementsByClassName("Discount");for(var i=0;i<applystates.length;i+=1){applystates[i].onclick=function(){var indexx=$(".Discount").index($(this));$(this).toggleClass("AC-active");$(".icon-Uncheck").eq(indexx).toggleClass("Discount-IMG")}}$scope.curriobject='';$.ajax({type:"post",url:"/cramCourse/getCourse",data:{'courseId':$scope.curriId,},datatype:"json",success:function(data){$scope.curriobject=data.object;if(data.object.try_out==1){$('.Discount').eq(0).toggleClass("AC-active");$('.icon-Uncheck').eq(0).toggleClass("Discount-IMG")}if(data.object.discount>0){$('.Discount').eq(1).toggleClass("AC-active");$('.icon-Uncheck').eq(1).toggleClass("Discount-IMG")}$scope.$apply()}});$scope.CreateCurri=function(){var CCurriData=$('#CreateCu').serializeArray();var totailmonek=CCurriData[3].value*CCurriData[4].value;var zhekouTF=0;if($('#mianfei').is('.AC-active')){zhekouTF=1}var zhenumbers=$('#zhenumber').val();$.ajax({type:"post",url:"/cramCourse/editCramCourse",data:{'c.id':$scope.curriId,'c.cram_school_id':$scope.cramSchoolId,'c.cram_course_group_id':CCurriData[0].value,'c.subject_id':CCurriData[1].value,'c.course_name':CCurriData[2].value,'c.course_hour':CCurriData[3].value,'c.hour_price':CCurriData[4].value,'c.original_price':totailmonek,'c.address':CCurriData[7].value,'c.introduction':CCurriData[8].value,'c.area_id':CCurriData[6].value,'c.penalty':CCurriData[5].value,'c.try_out':zhekouTF,'c.discount':zhenumbers,},datatype:"json",success:function(data){alert(data.msg);$location.path('/news/'+3);$scope.$apply()}})}}]).controller('curriculumCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.curriId=$routeParams.ID;$scope.stars='';$scope.curriobject='';$.ajax({type:"post",url:"/cramCourse/getCourse",data:{'courseId':$scope.curriId,},datatype:"json",success:function(data){$scope.curriobject=data.object;console.log(data);if(data.object.composite_score*10%10<=2&&data.object.composite_score*10%10!=0){$scope.stars='img/start2.png'}else if(data.object.composite_score*10%10<=5&&data.object.composite_score*10%10!=0){$scope.stars='img/start5.png'}else if(data.object.composite_score*10%10<=9&&data.object.composite_score*10%10!=0){$scope.stars='img/start8.png'}else if(data.object.composite_score==5){$scope.stars='img/start10.png'}else{$scope.stars='img/start0.png'}$scope.$apply()}});var EvpageSize=20;var EvpageIndex=1;$scope.EvaluateList='';$scope.totalRow='';$.ajax({type:"post",url:"/courseEvaluate/getEvaluateList",data:{'cramCourseId':$scope.curriId,'pageIndex':1,'pageSize':20},datatype:"json",success:function(data){$scope.totalRow=data.object.totalRow;$scope.EvaluateList=data.object.list;$scope.$apply()}});$(window).bind("scroll",function(){if($(document).scrollTop()+$(window).height()==$(document).height()){EvpageSize+=20;$.ajax({type:"post",url:"/courseEvaluate/getEvaluateList",data:{'cramCourseId':$scope.curriId,'pageIndex':EvpageIndex,'pageSize':EvpageSize},datatype:"json",success:function(data){$scope.EvaluateList=data.object.list;$scope.$apply()}})}})}])})(angular);
(function(angular){'use strict';angular.module('MFind',['ngRoute']).directive('onFinishRender',function($timeout){return{restrict:'A',link:function(scope,element,attr){if(scope.$last===true){$timeout(function(){scope.$emit('ngRepeatFinished')})}}}}).config(['$routeProvider',function($routeProvider){$routeProvider.when('/find/',{templateUrl:'find/find.html',controller:'findCtl'})}]).controller('findCtl',['$scope',function($scope){var findtabs=document.getElementsByClassName("findtabs");for(var i=0;i<findtabs.length;i+=1){findtabs[i].onclick=function(){var indexx=$(".findtabs").index($(this));for(var i=0;i<findtabs.length;i+=1){$(".findtabs").removeClass("activeFind");$(".findtabs1").removeClass("active")}$(this).addClass("activeFind");$(".findtabs1").eq(indexx).addClass("active")}}$scope.newslist='';$scope.inderBanner='';$.ajax({type:"post",url:"/api/mall/index?banner_category_id=1&toutiao_category_id=1",data:{},datatype:"json",success:function(data){$scope.newslist=data.object;$scope.inderBanner=data.object.inderBanner;$scope.$apply()}});$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){var swiper01=new Swiper('.swiper-container',{pagination:'.swiper-pagination',paginationClickable:true,grabCursor:true,touchRatio:0.5,autoplay:3000,loop:true})})}])})(angular);
(function(angular){'use strict';angular.module('Mme',['ngRoute']).directive('onFinishRender',function($timeout){return{restrict:'A',link:function(scope,element,attr){if(scope.$last===true){$timeout(function(){scope.$emit('ngRepeatFinished')})}}}}).config(['$routeProvider',function($routeProvider){$routeProvider.when('/my/',{templateUrl:'me/me.html',controller:'meCtl'}).when('/MyOrders/',{templateUrl:'me/MyOrders.html',controller:'MyOrdersCtl'}).when('/OrderDetails/:ID',{templateUrl:'me/OrderDetails.html',controller:'OrderDetailsCtl'}).when('/RefundDetails/:ID',{templateUrl:'me/RefundDetails.html',controller:'RefundDetailsCtl'}).when('/MyCollect/',{templateUrl:'me/MyCollect.html',controller:'MyCollectCtl'})}]).controller('meCtl',['$scope',function($scope){$scope.avatar='';$scope.name='';$scope.vip_type='';$scope.sex='';$scope.score='';$scope.balance='';$scope.ib_level='';$.post("/p/getMyInfo",{},function(data){$scope.ib_level=data.ib_level;$scope.avatar=data.avatar;$scope.name=data.name;$scope.vip_type=data.vip_type;$scope.sex=data.sex;$scope.score=data.score;$scope.balance=data.balance;$scope.$apply()})}]).controller('MyOrdersCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){tabsfn('SCart-tabs','.SCart-tabs','.SCart-tabs01','SCactive');var cancalReason=document.getElementsByClassName('cancalReason');for(var i=0;i<cancalReason.length;i+=1){cancalReason[i].onclick=function(){var indexx=$('.cancalReason').index($(this));for(var i=0;i<cancalReason.length;i+=1){$('.icon-Uncheck').removeClass('checksActive')}$('.icon-Uncheck').eq(indexx).addClass('checksActive')}}$scope.cancalReasonFadein=function(Oid){$('.cancalState').fadeIn();localStorage.setItem("DeleteOrderId",Oid)};$scope.cancalReasonFadeOut=function(){$('.cancalState').fadeOut()};$scope.goOrderDetails=function(OState,Oid){if(OState==0||OState==1||OState==2||OState==3||OState==4){$location.path('/OrderDetails/'+Oid)}else{$location.path('/RefundDetails/'+Oid)}};$scope.InsureDelete=function(){var Oid=localStorage.getItem("DeleteOrderId");var cancelReason=$('.checksActive').siblings().html();$.ajax({type:"post",url:"/order/cancelOrder",data:{"orderId":Oid,"cancelReason":cancelReason},datatype:"json",success:function(data){$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"pageIndex":1,"pageSize":20},datatype:"json",success:function(data){$scope.carmdAllLsits=data.object.list;$scope.$apply()}});$('.cancalState').fadeOut()}})};$scope.carmdAllLsits='';localStorage.setItem("orderStates",'');$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"pageIndex":1,"pageSize":20},datatype:"json",success:function(data){$('.spinner').fadeOut();$scope.carmdAllLsits=data.object.list;$scope.$apply()}});var CDtabs=document.getElementsByClassName('MyOrders-tabs');for(var i=0;i<CDtabs.length;i+=1){CDtabs[i].onclick=function(){var indexx=$('.MyOrders-tabs').index($(this));for(var i=0;i<CDtabs.length;i+=1){$('.MyOrders-tabs').removeClass('MOactive');$('.MyOrders-tabs01').removeClass("active")}if(indexx==0){$('.spinner').fadeIn();$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"pageIndex":1,"pageSize":20},datatype:"json",success:function(data){$scope.carmdAllLsits=data.object.list;$scope.$apply()}});localStorage.setItem("orderStates",'')}else if(indexx==1||indexx==2||indexx==3){$('.spinner').fadeIn();$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"pageIndex":1,"pageSize":20,"status":indexx-1,},datatype:"json",success:function(data){$scope.carmdAllLsits=data.object.list;$scope.$apply()}});localStorage.setItem("orderStates",indexx-1)}pageSizes=20;$('.spinner').fadeOut();$(this).addClass('MOactive');$('.MyOrders-tabs01').eq(indexx).addClass("active")}}var pageSizes=20;$(window).bind("scroll",function(){if($(document).scrollTop()+$(window).height()==$(document).height()){$('.spinner').fadeIn();var orderStates=localStorage.getItem("orderStates");pageSizes+=20;$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"pageIndex":1,"pageSize":pageSizes,"status":orderStates,},datatype:"json",success:function(data){$('.spinner').fadeOut();$scope.carmdAllLsits=data.object.list;$scope.$apply()}})}});}]).controller('OrderDetailsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var Oid=$routeParams.ID;$scope.OrderListDetail='';$scope.failureTimeH='';$scope.failureTimeM='';$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"orderId":Oid,},datatype:"json",success:function(data){$scope.OrderListDetail=data.object.list[0];$scope.failureTimeH=parseInt(data.object.list[0].failureTime/1000/60/60);$scope.failureTimeM=parseInt(((data.object.list[0].failureTime/1000/60/60)-$scope.failureTimeH)*60);$scope.$apply()}});setInterval(function(){$.ajax({type:"post",url:"/order/getOrderListForTeacher",data:{"orderId":Oid,},datatype:"json",success:function(data){$scope.failureTimeH=parseInt(data.object.list[0].failureTime/1000/60/60);$scope.failureTimeM=parseInt(((data.object.list[0].failureTime/1000/60/60)-$scope.failureTimeH)*60);$scope.$apply()}})},60000);var cancalReason=document.getElementsByClassName('cancalReason');for(var i=0;i<cancalReason.length;i+=1){cancalReason[i].onclick=function(){var indexx=$('.cancalReason').index($(this));for(var i=0;i<cancalReason.length;i+=1){$('.icon-Uncheck').removeClass('checksActive')}$('.icon-Uncheck').eq(indexx).addClass('checksActive')}}$scope.cancalReasonFadein=function(Oid){$('.cancalState').fadeIn();localStorage.setItem("DeleteOrderId",Oid)};$scope.cancalReasonFadeOut=function(){$('.cancalState').fadeOut()};$scope.InsureDelete=function(){var Oid=localStorage.getItem("DeleteOrderId");var cancelReason=$('.checksActive').siblings().html();$.ajax({type:"post",url:"/order/cancelOrder",data:{"orderId":Oid,"cancelReason":cancelReason},datatype:"json",success:function(data){$('.cancalState').fadeOut();alert(data.msg);$.ajax({type:"post",url:"/order/getOrderList",data:{"orderId":Oid,},datatype:"json",success:function(data){$scope.OrderListDetail=data.object.list[0];$scope.$apply()}})}})};$scope.goEvaluate=function(Oid){$location.path('/Evaluate/'+Oid)}}]).controller('RefundDetailsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.forceStop=function(){$('.HandleState02').fadeIn()};$scope.cancelForceStop=function(){$('.HandleState02').fadeOut();$('.HandleState03').fadeOut();$('.HandleState04').fadeOut()};$scope.insureForceStop=function(){$('.HandleState02').fadeOut();$('.HandleState01').fadeIn()};$scope.successForceStop=function(){$('.HandleState01').fadeOut()};$scope.AgreeRefund=function(){$('.HandleState03').fadeIn()};$scope.insureRefund=function(){$('.HandleState03').fadeOut()};$scope.RefuseRefund=function(){$('.HandleState04').fadeIn()};$scope.SubmitRReason=function(){$('.HandleState04').fadeOut()}}]).controller('MyCollectCtl',['$scope',function($scope){$scope.goback=function(){window.history.back()};$scope.CollectList='';$.ajax({type:"post",url:"/favorite/getFavoriteList",data:{},datatype:"json",success:function(data){$scope.CollectList=data.object;console.log(data);$scope.$apply()}});$scope.CollectDelete=function(id){$.ajax({type:"post",url:"/favorite/deleteFavorite",data:{"favoriteId":id},datatype:"json",success:function(data){$.ajax({type:"post",url:"/favorite/getFavoriteList",data:{},datatype:"json",success:function(data){$scope.CollectList=data.object;$scope.$apply()}});scartdelete('.MyCollect-container')}})};$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){scartdelete('.MyCollect-container')})}])})(angular);
(function(angular){'use strict';angular.module('Mnews',['ngRoute']).directive('onFinishRender',function($timeout){return{restrict:'A',link:function(scope,element,attr){if(scope.$last===true){$timeout(function(){scope.$emit('ngRepeatFinished')})}}}}).config(['$routeProvider',function($routeProvider){$routeProvider .when('/news/:ID',{templateUrl:'news/news.html',controller:'newsCtl'}).when('/kedanBegin/:ID',{templateUrl:'kedan/kedanBegin.html',controller:'kedanBeginCtl'}).when('/kedanPreview/',{templateUrl:'kedan/kedanPreview.html',controller:'KDPreviewCtl'}).when('/RequestClass/:ID',{templateUrl:'kedan/RequestClass.html',controller:'RequestClassCtl'}).when('/RCPreview/:ID',{templateUrl:'kedan/RequestClassPreview.html',controller:'RCPreviewCtl'}).when('/kedanDetails/:ID',{templateUrl:'kedan/kedanDetails.html',controller:'kedanDetailsCtl'}).when('/SeeClass/:ID',{templateUrl:'kedan/SeeClass.html',controller:'SeeClassCtl'}).when('/SCDetail/:ID',{templateUrl:'kedan/SeeClassDetails.html',controller:'SCDetailCtl'}).when('/CEnd/:ID',{templateUrl:'kedan/ClassEnd.html',controller:'CEndCtl'}).when('/CEndPre/:ID',{templateUrl:'kedan/ClassEndPreview.html',controller:'CEndPreCtl'}).when('/StopClass/:ID',{templateUrl:'kedan/StopClass.html',controller:'StopClassCtl'}).when('/BeginClass/:ID',{templateUrl:'news/BeginClass.html',controller:'BeginClassCtl'}).when('/ensureClass/:ID',{templateUrl:'news/ensureClass.html',controller:'ensureClassCtl'}).when('/AllClassDe/:ID',{templateUrl:'news/AllClassDe.html',controller:'AllClassDeCtl'}).when('/GLessons/:CID/:LID',{templateUrl:'news/GuitarLessons.html',controller:'GLessonsCtl'}).when('/PreLessons/:CID/:LID',{templateUrl:'news/PreLessons.html',controller:'PreLessonsCtl'}).when('/LDetai01/:ID',{templateUrl:'news/LessonsDetails01.html',controller:'LDetai01Ctl'}).when('/LDetai02/:ID',{templateUrl:'news/LessonsDetails02.html',controller:'LDetai02Ctl'}).when('/LDetai03/:ID',{templateUrl:'news/LessonsDetails03.html',controller:'LDetai03Ctl'}).when('/SingleClassDetail/:ID',{templateUrl:'news/SingleClassDetail.html',controller:'SingleClassDetailCtl'})}]).controller('newsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var state1234=$routeParams.ID;var CDtabs=document.getElementsByClassName('newstabs');for(var i=0;i<CDtabs.length;i+=1){for(var i=0;i<CDtabs.length;i+=1){$('.newstabs').removeClass('yewuactive');$('.newstabs1').removeClass("active")}$('.newstabs').eq(state1234).addClass('yewuactive');$('.newstabs1').eq(state1234).addClass("active")}var PTNumber=1;var PTSize=30;tabsfn('newstabs','.newstabs','.newstabs1','yewuactive');$scope.newslist=0;$.ajax({type:"post",url:"/c/chat",data:{},datatype:"json",success:function(data){$scope.newslist=data;$scope.$apply()}});$scope.zhankai='';$scope.Parentlist='';$.ajax({type:"post",url:"/t/getFriendsByTeacher",data:{"pageNumber":1,"pageSize":30,},datatype:"json",success:function(data){$scope.Parentlist=data.list;$scope.$apply()}});$(window).bind("scroll",function(){if($(document).scrollTop()+$(window).height()==$(document).height()){PTSize+20;$.ajax({type:"post",url:"/t/getFriendsByTeacher",data:{"pageNumber":PTNumber,"pageSize":PTSize,},datatype:"json",success:function(data){$scope.Parentlist=data.list;$scope.$apply()}});EvpageSize+=20;$.ajax({type:"post",url:"/courseEvaluate/getEvaluateList",data:{'schoolId':$scope.buxibanId,'pageIndex':EvpageIndex,'pageSize':EvpageSize},datatype:"json",success:function(data){$scope.EvaluateList=data.object.list;$scope.$apply()}})}});$scope.goWhere=function(id){var ParentID=id;localStorage.setItem("ParentID",ParentID);$.ajax({type:"post",url:"/c/curriculum/getCurriculumDraft",data:{"parentId":ParentID,},datatype:'json',success:function(data){$location.path('/kedanBegin/'+ParentID);$scope.$apply()}})};$scope.kedanlist='';$scope.kedanshow=function(id){var ParentID=id;$.ajax({type:"post",url:"/c/curriculum/getCurriculumList",data:{"pageNumber":1,"pageSize":100,"targetId":ParentID,},datatype:'json',success:function(data){$scope.kedanlist=data.content.list;$scope.$apply()}})};$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){var SingleOnOff=document.getElementsByClassName("showorhide");for(var i=0;i<SingleOnOff.length;i+=1){var a=1;SingleOnOff[i].onclick=function(){a+=1;var indexx=$(".showorhide").index($(this));for(var i=0;i<SingleOnOff.length;i+=1){$(".SingleDetails").slideUp("fast");$(".onoroff-open").addClass("opentxt");$(".onoroff-Close").removeClass("opentxt");$(".Billing").removeClass("Billinghide");$('.showorhide').removeClass("showorhide-active")}if(a%2==0){$(".SingleDetails").eq(indexx).stop(true,false).slideToggle("slow");$(".onoroff-open").eq(indexx).toggleClass("opentxt");$(".onoroff-Close").eq(indexx).toggleClass("opentxt");$(".Billing").eq(indexx).toggleClass("Billinghide");$('.showorhide').eq(indexx).toggleClass("showorhide-active")}}}});$scope.stateChange=function(id,state){var kedanID=id;var states=state;$.ajax({type:"post",url:"/c/curriculum/updateCurriculumState",data:{"currId":kedanID,"stateCode":states,},datatype:"json",success:function(data){window.location.reload()}})};$scope.CramData='';$scope.CramStates='';$scope.CramText='';$scope.stars='';$scope.groups1='';$scope.buxibanId='';$scope.groupcurri='';$scope.starslistA=[];var starsI='';$scope.quality_score='';$scope.quality_score01='';$scope.service_score='';$scope.service_score01='';var EvpageSize=20;var EvpageIndex=1;$scope.EvaluateList='';$scope.totalRow='';$scope.dianbustates=function(){$.ajax({type:"post",url:"/cramSchool/getCramSchoolState",data:{},datatype:"json",success:function(data){$scope.CramData=data.object;if($scope.CramData){$scope.buxibanId=data.object.id;$scope.quality_score=data.object.quality_score;$scope.service_score=data.object.service_score;if($scope.quality_score*10%10<=2&&$scope.quality_score*10%10!=0){$scope.quality_score01='img/start2.png'}else if($scope.quality_score*10%10<=5&&$scope.quality_score*10%10!=0){$scope.quality_score01='img/start5.png'}else if($scope.quality_score*10%10<=9&&$scope.quality_score*10%10!=0){$scope.quality_score01='img/start8.png'}else if($scope.quality_score==5){$scope.quality_score01='img/start10.png'}else{$scope.quality_score01='img/start0.png'}if($scope.service_score*10%10<=2&&$scope.service_score*10%10!=0){$scope.service_score01='img/start2.png'}else if($scope.service_score*10%10<=5&&$scope.service_score*10%10!=0){$scope.service_score01='img/start5.png'}else if($scope.service_score*10%10<=9&&$scope.service_score*10%10!=0){$scope.service_score01='img/start8.png'}else if($scope.service_score==5){$scope.service_score01='img/start10.png'}else{$scope.service_score01='img/start0.png'}$scope.groups1=data.object.groups[0];if($scope.CramData.eva_star*10%10<=2&&$scope.CramData.eva_star*10%10!=0){$scope.stars='img/start2.png'}else if($scope.CramData.eva_star*10%10<=5&&$scope.CramData.eva_star*10%10!=0){$scope.stars='img/start5.png'}else if($scope.CramData.eva_star*10%10<=9&&$scope.CramData.eva_star*10%10!=0){$scope.stars='img/start8.png'}else if($scope.CramData.eva_star==5){$scope.stars='img/start10.png'}else{$scope.stars='img/start0.png'}}if(!$scope.CramData){$scope.CramStates='icon-Establish';$scope.CramText='您还没有班级，赶紧创建一个，成为班主任吧';$('#ApplyState').show();$('#CDetails').hide()}else if(data.object.state==1){$scope.CramStates='icon-examineing';$scope.CramText='您未支付补习班保证金，请尽快支付';$('#ApplyState').show();$('#CDetails').hide()}else if(data.object.state==2){$scope.CramStates='icon-examineing';$scope.CramText='您的申请已提交，项目经理将尽快审核，请耐心等候';$('#ApplyState').show();$('#CDetails').hide()}else if(data.object.state==4){$scope.CramStates='icon-examine-not';$scope.CramText='您没有通过第壹家教补习班申请资格。保证金将退还到您的账户余额。七天之后可以再次申请哦!';$('#ApplyState').show();$('#CDetails').hide()}else if(data.object.state==3){$('#ApplyState').hide();$('#CDetails').show();$.ajax({type:"post",url:"/cramCourse/getCramCourse",data:{"schoolId":$scope.groups1.cramSchoolId,"groupId":$scope.groups1.id,},datatype:"json",success:function(data){$scope.groupcurri=data.object.list;if($scope.groupcurri[0].composite_score*10%10<=2&&$scope.groupcurri[0].composite_score*10%10!=0){starsI='img/start2.png'}else if($scope.groupcurri[0].composite_score*10%10<=5&&$scope.groupcurri[0].composite_score*10%10!=0){starsI='img/start5.png'}else if($scope.groupcurri[0].composite_score*10%10<=9&&$scope.groupcurri[0].composite_score*10%10!=0){starsI='img/start8.png'}else if($scope.groupcurri[0].composite_score==5){starsI='img/start10.png'}else{starsI='img/start0.png'}$scope.starslistA.push(starsI);$scope.$apply()}})}$.ajax({type:"post",url:"/courseEvaluate/getEvaluateList",data:{'schoolId':$scope.buxibanId,'pageIndex':1,'pageSize':20},datatype:"json",success:function(data){$scope.totalRow=data.object.totalRow;$scope.EvaluateList=data.object.list;$scope.$apply()}});$scope.$apply()}})};$scope.dianbustates();$scope.Cramgowhere=function(a){var craminfo=a;if(!a){$location.path('/applycram/')}else if(a.state==1){$location.path('/applycram/')}};tabsfn('CDtabs','.CDtabs','.CDtabs1','CDactive');$('.Plus').click(function(){$(this).toggleClass('Plus-active');$('.SetUp').toggleClass('SetUpAnimate')});$('.SetUp-child').click(function(){$(this).addClass('tabItemactive');setTimeout(function(){$('.SetUp').removeClass('SetUpAnimate');$('.SetUp-child').removeClass('tabItemactive')},500)});$scope.fgcurri=function(schoolId,groupID,$event){var groupID=groupID;var schoolId=schoolId;$scope.starslistA=[];$.ajax({type:"post",url:"/cramCourse/getCramCourse",data:{"schoolId":schoolId,"groupId":groupID,},datatype:"json",success:function(data){$scope.groupcurri=data.object.list;for(var i=0;i<$scope.groupcurri.length;i+=1){if($scope.groupcurri[i].composite_score*10%10<=2&&$scope.groupcurri[i].composite_score*10%10!=0){starsI='img/start2.png'}else if($scope.groupcurri[i].composite_score*10%10<=5&&$scope.groupcurri[i].composite_score*10%10!=0){starsI='img/start5.png'}else if($scope.groupcurri[i].composite_score*10%10<=9&&$scope.groupcurri[i].composite_score*10%10!=0){starsI='img/start8.png'}else if($scope.groupcurri[i].composite_score==5){starsI='img/start10.png'}else{starsI='img/start0.png'}$scope.starslistA.push(starsI)}$scope.$apply()}});$('.tabBody').removeClass('tabItemactive');$($event.target).addClass("tabItemactive")};$scope.gocurriculum=function(curriID){$location.path('/curriculum/'+curriID)};$scope.LessonsList='';$scope.getmyLessons=function(){$.ajax({type:"post",url:"/cramCourse/getCourseByTeacher",data:{},datatype:"json",success:function(data){$scope.LessonsList=data.object;$scope.$apply()}});localStorage.setItem('order_items','');localStorage.setItem('items_number','');localStorage.setItem('attend_class_hour','');localStorage.setItem('course_date','');localStorage.setItem('course_time','');localStorage.setItem('over_time','');localStorage.setItem('address','');localStorage.setItem('plan','')};$scope.getmyLessons()}]).controller('kedanBeginCtl',['$scope',function($scope){$scope.kedanStart=function(){var KDdata=$("form").serializeArray();localStorage.setItem("type",KDdata[0].value);localStorage.setItem("studentName",KDdata[1].value);localStorage.setItem("subjectId",KDdata[2].value);localStorage.setItem("grade",KDdata[3].value);localStorage.setItem("hourSubsidy",KDdata[4].value);localStorage.setItem("totalHours",KDdata[5].value);localStorage.setItem("frequency",KDdata[6].value);localStorage.setItem("place",KDdata[7].value);localStorage.setItem("address",KDdata[8].value);localStorage.setItem("penalty",KDdata[9].value);localStorage.setItem("memo",KDdata[10].value)}}]).controller('KDPreviewCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var ParentID=window.localStorage.getItem("ParentID");var type=window.localStorage.getItem("type");$scope.type='';if(type==1){$scope.type='常规课程'}$scope.studentName=window.localStorage.getItem("studentName");var subjectId=window.localStorage.getItem("subjectId");$scope.subjectId='';if(subjectId==2){$scope.subjectId='小学/全科'}else if(subjectId==3){$scope.subjectId='小学/语文'}else if(subjectId==4){$scope.subjectId='小学/数学'}else if(subjectId==5){$scope.subjectId='小学/英语'}else if(subjectId==7){$scope.subjectId='初中/全科'}else if(subjectId==8){$scope.subjectId='初中/语文'}else if(subjectId==9){$scope.subjectId='初中/数学'}else if(subjectId==10){$scope.subjectId='初中/英语'}else if(subjectId==11){$scope.subjectId='初中/物理'}else if(subjectId==12){$scope.subjectId='初中/地理'}else if(subjectId==13){$scope.subjectId='初中/生物'}else if(subjectId==14){$scope.subjectId='初中/化学'}else if(subjectId==15){$scope.subjectId='初中/历史'}else if(subjectId==16){$scope.subjectId='初中/政治'}else if(subjectId==18){$scope.subjectId='高中/全科'}else if(subjectId==19){$scope.subjectId='高中/语文'}else if(subjectId==20){$scope.subjectId='高中/数学'}else if(subjectId==21){$scope.subjectId='高中/英语'}else if(subjectId==22){$scope.subjectId='高中/物理'}else if(subjectId==23){$scope.subjectId='高中/地理'}else if(subjectId==24){$scope.subjectId='高中/生物'}else if(subjectId==25){$scope.subjectId='高中/化学'}else if(subjectId==26){$scope.subjectId='高中/历史'}else if(subjectId==27){$scope.subjectId='高中/政治'}$scope.grade=window.localStorage.getItem("grade");$scope.hourSubsidy=window.localStorage.getItem("hourSubsidy");$scope.totalHours=window.localStorage.getItem("totalHours");$scope.frequency=window.localStorage.getItem("frequency");var place=window.localStorage.getItem("place");$scope.place='';if(place==1){$scope.place='学生家中'}else if(place==2){$scope.place='老师家中'}else if(place==3){$scope.place='双方约定地点'}$scope.totalMoney=$scope.hourSubsidy*$scope.totalHours;$scope.address=window.localStorage.getItem("address");var penalty=window.localStorage.getItem("penalty");$scope.weiyuejin='';if(penalty){$scope.weiyuejin=penalty*$scope.totalMoney/100}else{$scope.weiyuejin=0}$scope.memo=window.localStorage.getItem("memo");$scope.time=new Date().getTime();$scope.goback=function(){$location.path('/kedanBegin/'+ParentID)};$scope.OKStart=function(){$.ajax({type:"post",url:"/c/curriculum/creatCurriculum",data:{"c.target_id":ParentID,"c.type":type,"c.student_name":$scope.studentName,"c.subject_id":subjectId,"c.grade":$scope.grade,"c.hour_subsidy":$scope.hourSubsidy,"c.total_hours":$scope.totalHours,"c.frequency":$scope.frequency,"c.place":place,"c.address":$scope.address,"c.penalty":penalty,"c.memo":$scope.memo,},datatype:'json',success:function(data){alert("课单发送成功，等待家长确认。");$location.path('/news/'+1);$scope.$apply()}})}}]).controller('RequestClassCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.currId=$routeParams.ID;$scope.surplusHouer='';$.ajax({type:"post",url:"/c/curriculum/getCurriculumInfo",data:{"currId":$scope.currId,},datatype:"json",success:function(data){$scope.surplusHouer=data.object.surplusHouer;$scope.$apply()}});$scope.startClass=function(){var classlists=$("form").serializeArray();localStorage.setItem("classHour",classlists[0].value);localStorage.setItem("appDate",classlists[1].value);localStorage.setItem("TimeStard",classlists[2].value);localStorage.setItem("TimeEnd",classlists[3].value);localStorage.setItem("place",classlists[4].value);localStorage.setItem("address",classlists[5].value);localStorage.setItem("plan",classlists[6].value)}}]).controller('RCPreviewCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.currId=$routeParams.ID;$scope.classHour=window.localStorage.getItem("classHour");$scope.appDate=window.localStorage.getItem("appDate");$scope.TimeStard=window.localStorage.getItem("TimeStard");$scope.TimeEnd=window.localStorage.getItem("TimeEnd");var placestate=window.localStorage.getItem("place");$scope.place='';if(placestate==1){$scope.place='学生家中'}else if(placestate==2){$scope.place='老师家中'}else if(placestate==3){$scope.place='双方约定地点'}$scope.address=window.localStorage.getItem("address");$scope.plan=window.localStorage.getItem("plan");$scope.time=new Date().getTime();$scope.submitClass=function(){$.ajax({type:"post",url:"/c/curriculumClass/saveClass",data:{"currId":$scope.currId,"c.class_hour":$scope.classHour,"c.class_begin_date":$scope.appDate,"c.class_begin_time":$scope.TimeStard,"c.class_over_time":$scope.TimeEnd,"c.place":placestate,"c.address":$scope.address,"c.plan":$scope.plan,},datatype:"json",success:function(data){alert("课次已成功发送");$location.path('/SeeClass/'+$scope.currId);$scope.$apply()}})}}]).controller('kedanDetailsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var currId=$routeParams.ID;$scope.typeText='';$scope.studentName='';$scope.subjectText='';$scope.grade='';$scope.hour_subsidy='';$scope.total_hours='';$scope.frequency='';$scope.placeText='';$scope.address='';$scope.order_amount='';$scope.penaltyAmount='';$scope.in_time='';$scope.memo='';$scope.state='';$scope.currId=currId;$.ajax({type:"post",url:"/c/curriculum/getCurriculumInfo",data:{"currId":currId},datatype:"json",success:function(data){$scope.typeText=data.object.typeText;$scope.studentName=data.object.student_name;$scope.subjectText=data.object.subjectText;$scope.grade=data.object.grade;$scope.hour_subsidy=data.object.hour_subsidy;$scope.total_hours=data.object.total_hours;$scope.frequency=data.object.frequency;$scope.placeText=data.object.placeText;$scope.address=data.object.address;$scope.order_amount=data.object.order_amount;$scope.penaltyAmount=data.object.penaltyAmount;$scope.in_time=data.object.in_time;$scope.memo=data.object.memo;$scope.state=data.object.state;$scope.$apply()}});$scope.stateChange=function(state){var states=state;$.ajax({type:"post",url:"/c/curriculum/updateCurriculumState",data:{"currId":currId,"stateCode":states,},datatype:"json",success:function(data){$location.path('/news/'+1);$scope.$apply()}})}}]).controller('SeeClassCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var currId=$routeParams.ID;$scope.keciList='';$.ajax({type:"post",url:"/c/curriculumClass/getClassListBycurr",data:{"currId":currId,},datatype:"json",success:function(data){$scope.keciList=data.object;console.log(data);$scope.$apply()}});$scope.Report=function(id,report){var classId=id;var reports=report;console.log(classId);console.log(reports);if(reports){$location.path('/CEndPre/'+classId)}else{$location.path('/CEnd/'+classId)}}}]).controller('SCDetailCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var classId=$routeParams.ID;$.ajax({type:"post",url:"/c/curriculumClass/getClassInfo",data:{"classId":classId,},datatype:"json",success:function(data){$scope.kecis=data.object;$scope.$apply()}});$scope.cancelClass=function(kedanID){var currId=kedanID;$.ajax({type:"post",url:"/c/curriculumClass/cancelClass",data:{"classId":classId,},datatype:"json",success:function(data){$location.path('/SeeClass/'+currId);$scope.$apply()}})}}]).controller('CEndCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.classId=$routeParams.ID;$scope.class_hour='';$.ajax({type:"post",url:"/c/curriculumClass/getClassInfo",data:{"classId":$scope.classId,},datatype:"json",success:function(data){$scope.class_hour=data.object.class_hour;$scope.$apply()}});$scope.SCEnd=function(){var SCReport=$("form").serializeArray();localStorage.setItem("CHour",SCReport[0].value);localStorage.setItem("appDate1",SCReport[1].value);localStorage.setItem("TimeStard1",SCReport[2].value);localStorage.setItem("TimeEnd1",SCReport[3].value);localStorage.setItem("report",SCReport[4].value)}}]).controller('CEndPreCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.classId=$routeParams.ID;$scope.CHour='';$scope.appDate1='';$scope.TimeStard1='';$scope.TimeEnd1='';$scope.report='';$scope.plan='';$scope.totalMN='';$scope.currId='';$.ajax({type:"post",url:"/c/curriculumClass/getClassInfo",data:{"classId":$scope.classId,},datatype:"json",success:function(data){if(data.object.report){$scope.CHour=data.object.class_hour;$scope.appDate1=data.object.class_begin_date;$scope.TimeStard1=data.object.class_begin_time;$scope.TimeEnd1=data.object.class_over_time;$scope.report=data.object.report}else if(!data.object.report){$scope.CHour=window.localStorage.getItem("CHour");$scope.appDate1=window.localStorage.getItem("appDate1");$scope.TimeStard1=window.localStorage.getItem("TimeStard1");$scope.TimeEnd1=window.localStorage.getItem("TimeEnd1");$scope.report=window.localStorage.getItem("report")}$scope.currId=data.object.curriculum_id;$scope.totalMN=$scope.CHour*data.object.hourSubsidy;$scope.plan=data.object.plan;$scope.currId=data.object.curriculum_id;$scope.$apply()}});$scope.CreateReport=function(currId){var currId=currId;$.ajax({type:"post",url:"/c/curriculumClass/reportClass",data:{"classId":$scope.classId,"c.class_hour":$scope.CHour,"c.class_begin_date":$scope.appDate1,"c.class_begin_time":$scope.TimeStard1,"c.class_over_time":$scope.TimeEnd1,"c.report":$scope.report,},datatype:"json",success:function(data){alert("结课报告已发送，请耐心等待家长确认");$location.path('/SeeClass/'+currId);$scope.$apply()}})}}]).controller('StopClassCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var currId=$routeParams.ID;$scope.submitResure=function(){var resure=$("textarea").val();if(resure){$.ajax({type:"post",url:"/c/curriculum/updateCurriculumState",data:{"currId":currId,"stateCode":11,"stopReason":resure,},datatype:"json",success:function(data){alert("协商请求已发送，请耐心等待家长回复");$location.path('/news/'+1);$scope.$apply()}})}else{alert("请填写您中止的原因")}}}]).controller('BeginClassCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var courseId=$routeParams.ID;$scope.order_items=localStorage.getItem('order_items');$scope.items_number=localStorage.getItem('items_number').replace(/[^0-9]/ig,"");$scope.attend_class_hour=localStorage.getItem('attend_class_hour');$scope.course_date=localStorage.getItem('course_date');$scope.course_time=localStorage.getItem('course_time');$scope.over_time=localStorage.getItem('over_time');$scope.address=localStorage.getItem('address');$scope.plan=localStorage.getItem('plan');$scope.studentlist='';$scope.Sestudents=function(){$('#BeginClass').fadeOut();$.ajax({type:"post",url:"/cramLesson/findStudentInfos",data:{"courseId":courseId,},datatype:"json",success:function(data){$scope.studentlist=data.object;$scope.$apply()}});$('#Sestudents').fadeIn()};$scope.cancelSelect=function(){$('#Sestudents').fadeOut();$('#BeginClass').fadeIn()};$scope.ensureSelect=function(){$('#Sestudents').fadeOut();$('#sele-students').val($('.Ses-tabs-L').html());$('#BeginClass').fadeIn()};$scope.checkmountStu=0;$scope.SeAllStudents=function(){if($('.BC-checkAll').hasClass('checksActiveAll')){$('.BC-checkAll').removeClass('checksActiveAll');$('.BC-check01').removeClass('checksActive');$('.BC-listTop').removeClass('BC-active');$scope.checkmountStu=0;studentsIDList=[]}else if(!$('.BC-checkAll').hasClass('checksActiveAll')){$('.BC-checkAll').addClass('checksActiveAll');$('.BC-check01').addClass('checksActive');$('.BC-listTop').addClass('BC-active');$scope.checkmountStu=$('.checksActive').length;var SeStu01=document.getElementsByClassName("BC-check01");for(var i=0;i<SeStu01.length;i+=1){studentsIDList.push($('.BC-check01').eq(i).attr('data-studentID'))}}};var studentsIDList=[];$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){var SeStu=document.getElementsByClassName("BC-check01");for(var i=0;i<SeStu.length;i+=1){SeStu[i].onclick=function(){var indexx=$(".BC-check01").index($(this));$(this).toggleClass('checksActive');$('.BC-listTop').eq(indexx).toggleClass('BC-active');$scope.checkmountStu=$('.checksActive').length;studentsIDList.push($(this).attr('data-studentID'));$scope.$apply()}}});$scope.generateLessons=function(){var LessonsText=$('#BC-data').serializeArray();localStorage.setItem('order_items',studentsIDList);localStorage.setItem('items_number',LessonsText[0].value);localStorage.setItem('attend_class_hour',LessonsText[1].value);localStorage.setItem('course_date',LessonsText[2].value);localStorage.setItem('course_time',LessonsText[3].value);localStorage.setItem('over_time',LessonsText[4].value);localStorage.setItem('address',LessonsText[5].value);localStorage.setItem('plan',LessonsText[6].value);$location.path('/ensureClass/'+courseId)}}]).controller('ensureClassCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){$scope.courseId=$routeParams.ID;$scope.order_items=localStorage.getItem('order_items').toString();$scope.items_number=localStorage.getItem('items_number').replace(/[^0-9]/ig,"");$scope.attend_class_hour=localStorage.getItem('attend_class_hour');$scope.course_date=localStorage.getItem('course_date');$scope.course_time=localStorage.getItem('course_time');$scope.over_time=localStorage.getItem('over_time');$scope.address=localStorage.getItem('address');$scope.plan=localStorage.getItem('plan');$scope.submitClass=function(){$.ajax({type:"post",url:"/cramLesson/createLesson",data:{"le.courser_id":$scope.courseId,"le.order_items":$scope.order_items,"le.attend_class_hour":$scope.attend_class_hour,"le.course_date":$scope.course_date,"le.course_time":$scope.course_time,"le.over_time":$scope.over_time,"le.address":$scope.address,"le.plan":$scope.plan,},datatype:"json",success:function(data){alert(data.msg);$location.path('/AllClassDe/'+$scope.courseId);$scope.$apply()}})}}]).controller('AllClassDeCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var courseId=$routeParams.ID;localStorage.setItem('items_number','');localStorage.setItem('attend_class_hour','');localStorage.setItem('course_date','');localStorage.setItem('course_time','');localStorage.setItem('over_time','');localStorage.setItem('report','');$scope.goback=function(){$location.path('/news/'+2)};$scope.lessonchildsList='';$.ajax({type:"post",url:"/cramLesson/getLessonListByCourse",data:{"courseId":courseId,},datatype:"json",success:function(data){$scope.lessonchildsList=data.object;$scope.$apply()}});$scope.goLessonchildDetail=function(state,id){if(state==0){$location.path('/LDetai01/'+id)}else if(state==1){$location.path('/LDetai02/'+id)}else if(state==2){$location.path('/LDetai03/'+id)}}}]).controller('GLessonsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var courseId=$routeParams.CID;var lessonId=$routeParams.LID;$scope.goback=function(){window.history.back()};$scope.order_items=localStorage.getItem('order_items').toString();$scope.items_number=localStorage.getItem('items_number');$scope.course_time=localStorage.getItem('course_time');$scope.over_time=localStorage.getItem('over_time');$scope.plan=localStorage.getItem('report');$scope.studentlist='';$scope.Sestudents=function(){$('.GuitarLessons').fadeOut();$.ajax({type:"post",url:"/cramLesson/findStudentInfos",data:{"courseId":courseId,},datatype:"json",success:function(data){$scope.studentlist=data.object;$scope.$apply()}});$('#Sestudents').fadeIn()};$scope.cancelSelect=function(){$('#Sestudents').fadeOut();$('.GuitarLessons').fadeIn()};$scope.ensureSelect=function(){$('#Sestudents').fadeOut();$('#sele-students').val($('.Ses-tabs-L').html());$('.GuitarLessons').fadeIn()};$scope.checkmountStu=0;$scope.SeAllStudents=function(){if($('.BC-checkAll').hasClass('checksActiveAll')){$('.BC-checkAll').removeClass('checksActiveAll');$('.BC-check01').removeClass('checksActive');$('.BC-listTop').removeClass('BC-active');$scope.checkmountStu=0;studentsIDList=[]}else if(!$('.BC-checkAll').hasClass('checksActiveAll')){$('.BC-checkAll').addClass('checksActiveAll');$('.BC-check01').addClass('checksActive');$('.BC-listTop').addClass('BC-active');$scope.checkmountStu=$('.checksActive').length;var SeStu01=document.getElementsByClassName("BC-check01");for(var i=0;i<SeStu01.length;i+=1){studentsIDList.push($('.BC-check01').eq(i).attr('data-studentID'))}}};var studentsIDList=[];$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){var SeStu=document.getElementsByClassName("BC-check01");for(var i=0;i<SeStu.length;i+=1){SeStu[i].onclick=function(){var indexx=$(".BC-check01").index($(this));$(this).toggleClass('checksActive');$('.BC-listTop').eq(indexx).toggleClass('BC-active');$scope.checkmountStu=$('.checksActive').length;studentsIDList.push($(this).attr('data-studentID'));$scope.$apply()}}});$scope.PreReport=function(){var LessonsText=$('#BC-data').serializeArray();localStorage.setItem('order_items',studentsIDList);localStorage.setItem('items_number',LessonsText[0].value);localStorage.setItem('attend_class_hour',LessonsText[1].value);localStorage.setItem('course_date',LessonsText[2].value);localStorage.setItem('course_time',LessonsText[3].value);localStorage.setItem('over_time',LessonsText[4].value);localStorage.setItem('report',LessonsText[5].value);$location.path('/PreLessons/'+courseId+'/'+lessonId)}}]).controller('PreLessonsCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var courseId=$routeParams.CID;var lessonId=$routeParams.LID;$scope.goback=function(){window.history.back()};$scope.order_items=localStorage.getItem('order_items').toString();$scope.items_number=localStorage.getItem('items_number').replace(/[^0-9]/ig,"");$scope.attend_class_hour=localStorage.getItem('attend_class_hour');$scope.course_date=localStorage.getItem('course_date');$scope.course_time=localStorage.getItem('course_time');$scope.over_time=localStorage.getItem('over_time');$scope.report=localStorage.getItem('report');$scope.lessonPlan='';$.ajax({type:"post",url:"/cramLesson/getLessons",data:{"cramLessonsId":lessonId,},datatype:"json",success:function(data){$scope.lessonPlan=data.object.plan;$scope.$apply()}});$scope.CreateReport=function(){$.ajax({type:"post",url:"/cramLesson/sponsorFinishClass",data:{"cramLessonId":lessonId,'le.order_items':$scope.order_items,'le.attend_class_hour':$scope.attend_class_hour,'le.course_date':$scope.course_date,'le.course_time':$scope.course_time,'le.over_time':$scope.over_time,'le.report':$scope.report,},datatype:"json",success:function(data){alert(data.msg);if(data.isSuccess){$location.path('/AllClassDe/'+courseId)}$scope.$apply()}})}}]).controller('LDetai01Ctl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var cramLessonsId=$routeParams.ID;$scope.goback=function(courserId){$location.path('/AllClassDe/'+courserId)};$scope.cramLessondata='';$.ajax({type:"post",url:"/cramLesson/getLessons",data:{"cramLessonsId":cramLessonsId,},datatype:"json",success:function(data){$scope.cramLessondata=data.object;$scope.$apply()}})}]).controller('LDetai02Ctl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var cramLessonId=$routeParams.ID;$scope.goback=function(courserId){$location.path('/AllClassDe/'+courserId)};$scope.UnconfirmedStudent='';$scope.Sestudents=function(){$('.LessonsDet').fadeOut();$.ajax({type:"post",url:"/cramLesson/getUnconfirmedStudentList",data:{"cramLessonId":cramLessonId,},datatype:"json",success:function(data){$scope.UnconfirmedStudent=data.object;$scope.$apply()}});$('#Sestudents').fadeIn()};$scope.rejectStudent='';$scope.Sestudents01=function(){$('.LessonsDet').fadeOut();$.ajax({type:"post",url:"/cramLesson/rejectStudentList",data:{"cramLessonId":cramLessonId,},datatype:"json",success:function(data){$scope.rejectStudent=data.object;$scope.$apply()}});$('#Sestudents01').fadeIn()};var rejectStudentIDList=[];$scope.cancelSelect=function(){$('#Sestudents').fadeOut();$('#Sestudents01').fadeOut();$('.LessonsDet').fadeIn();rejectStudentIDList=[]};var rejectStudentIDList=[];$scope.$on('ngRepeatFinished',function(ngRepeatFinishedEvent){var SeStu=document.getElementsByClassName("BC-check01");for(var i=0;i<SeStu.length;i+=1){SeStu[i].onclick=function(){var indexx=$(".BC-check01").index($(this));$(this).toggleClass('checksActive');$('.BC-listTop').eq(indexx).toggleClass('BC-active');$scope.checkmountStu=$('.checksActive').length;rejectStudentIDList.push($(this).attr('data-RStudentId'));$scope.$apply()}}});$scope.GuitarAgain=function(Lid){$.ajax({type:"post",url:"/cramLesson/againFinishClass",data:{"cramLessonId":Lid,"cramLessonItemIds":rejectStudentIDList.toString(),},datatype:"json",success:function(data){alert(data.msg);if(data.isSuccess){$('#Sestudents01').fadeOut()}}})};$scope.cramLessondata='';$.ajax({type:"post",url:"/cramLesson/getLessons",data:{"cramLessonsId":cramLessonId,},datatype:"json",success:function(data){$scope.cramLessondata=data.object;$scope.$apply()}})}]).controller('LDetai03Ctl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var cramLessonsId=$routeParams.ID;$scope.goback=function(courserId){$location.path('/AllClassDe/'+courserId)};$scope.cramLessondata='';$scope.lessonPlan='';$.ajax({type:"post",url:"/cramLesson/getLessons",data:{"cramLessonsId":cramLessonsId,},datatype:"json",success:function(data){$scope.cramLessondata=data.object;$scope.$apply()}})}]).controller('SingleClassDetailCtl',['$scope','$route','$location','$routeParams',function($scope,$route,$location,$routeParams){var courseId=$routeParams.ID;$scope.goback=function(){window.history.back()};$scope.SingleClassinfo='';$.ajax({type:"post",url:"/cramCourse/getCourse",data:{"courseId":courseId,},datatype:"json",success:function(data){$scope.SingleClassinfo=data.object;$scope.$apply()}})}])})(angular);
(function(angular){'use strict';angular.module('Mvip',['ngRoute']).config(['$routeProvider',function($routeProvider){$routeProvider.when('/vip/',{templateUrl:'vip/vip.html',controller:'vipCtl'})}]).controller('vipCtl',['$scope',function($scope){$scope.viptype='m';$scope.paytype=1;$scope.viptime=1;$scope.Totalamount=30;$scope.originalPrice=360;$scope.yuanonoff=true;$scope.vipService=function($event){$($event.target).toggleClass('greedborder-active')};$scope.monthandyear=function($event,viptype){$scope.viptype=viptype;$scope.viptime=1;if($scope.viptype=="y"&&$scope.viptime>0){if($scope.viptime==1){$scope.Totalamount=100;$scope.originalPrice=360}}else if($scope.viptype=="m"&&$scope.viptime>0){if($scope.viptime==1){$scope.Totalamount=30}}else{$scope.Totalamount="查询异常";$scope.yuanonoff=false}$(".tehui").click(function(e){e.stopPropagation();e.preventDefault()});$('.month-year').removeClass('greedborder-active');$($event.target).addClass('greedborder-active');$scope.page=$event.target.getAttribute('data-vip');$('.month-year-show').css('display','none');$('.month-year-show').eq($scope.page).css('display','block')};$scope.paystyle=function($event,paytype){$scope.paytype=paytype;$('.pay-style').removeClass('greedborder-active');$($event.target).addClass('greedborder-active')};$scope.name='';$scope.balance='';$scope.teacherVip='';$scope.sex='';$scope.avatar='';$scope.vip_end_time='';var resetvip=function(){$.ajax({type:"post",url:"/p/getMyInfo",data:{},datatype:"json",success:function(data){$scope.name=data.name;$scope.balance=data.balance;$scope.teacherVip=data.teacherVip;$scope.sex=data.sex;$scope.avatar=data.avatar;$scope.vip_end_time=data.teacherVipEndTime;$scope.$apply()}})};resetvip();$scope.inputviptime=function(viptime){$scope.viptime=viptime;$.ajax({type:"post",url:"/c/getVipPrice",data:{"type":$scope.viptype,"no":viptime},datatype:"json",success:function(data){$scope.Totalamount=data.msg;$scope.originalPrice=data.originalPrice;$scope.yuanonoff=data.isSuccess;if($scope.viptype=="y"&&$scope.viptime>0){if($scope.viptime==1){$scope.Totalamount=100;$scope.originalPrice=360}}else if($scope.viptype=="m"&&$scope.viptime>0){if($scope.viptime==1){$scope.Totalamount=30}}else{$scope.Totalamount="查询异常";$scope.yuanonoff=false}$scope.$apply()}})};$scope.submitpay=function(Totalamount,balance){if($scope.paytype==1){window.location.href="/c/pay/openVipByWechatPay?type="+$scope.viptype+"&no="+$scope.viptime+"&identity=2"}else if($scope.paytype==2){if(Totalamount<=balance){$.ajax({type:"post",url:"/c/openVip",data:{"type":$scope.viptype,"no":$scope.viptime,"identity":2},datatype:"json",success:function(data){alert(data.msg);resetvip();$scope.$apply()}})}else{alert("余额不足，使用微信支付或先充值")}}}}])})(angular);